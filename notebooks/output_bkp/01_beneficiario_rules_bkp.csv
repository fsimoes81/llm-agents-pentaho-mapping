column_name,alias,rule
BEN.NAOTEMCARENCIA,NAO_TEM_CARENCIA,"DECODE(BEN.NAOTEMCARENCIA, 'S','Sim','N','Não')"
BEN.SOFREUADAPTACAO,SOFREU_ADAPTACAO,"DECODE(BEN.SOFREUADAPTACAO, 1,'Não',2,'Sim')"
BEN.TABORIGEM,ORIGEM,"DECODE(BEN.TABORIGEM, 1,'Próprio',2,'Assumido',3,'Assumido-Eventual')"
BEN.BLOQUEIARECADBIOAUTORIZADORWEB,BLOQUEAR_RECAD_BIO_AUT_WEB,"DECODE(BEN.BLOQUEIARECADBIOAUTORIZADORWEB,'S','Sim','N','Não')"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
BEN.MOTIVOCANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.INTERCAMBIO,INTERCAMBIO,"CASE WHEN CON.INTERCAMBIO = 1 THEN 'Sim' WHEN CON.INTERCAMBIO = 2 THEN 'Não' END"
CON.LOCALFATURAMENTO,LOCAL_FATURAMENTO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
BEN.MATRICULAFUNCIONAL,MATRIC_BEN_EMPRESA,"CASE WHEN CON.CONTRATO = 53478 AND TPDEP.DESCRICAO = 'Titular' THEN LPAD(BEN.MATRICULAFUNCIONAL,6,0) ELSE BEN.MATRICULAFUNCIONAL END"
UNIO.CODIGO,UNIMED_ORIGEM,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMP,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REP,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP, SAM_UNIMED           UNI, SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
BEN.BENEFICIARIO,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
CON.LOCALFATURAMENTO,ID_RESP_FINANCEIRO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN CPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'L' THEN LPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN FBEN.HANDLE WHEN FAM.PESSOARESPONSAVEL  IS NOT NULL THEN SFNP.HANDLE END END"
BEN.DATACANCELAMENTO,DATA_REATIVACAO,"CASE WHEN BEN.DATACANCELAMENTO > REATIVACAO.DATA_REATIVACAO THEN NULL ELSE REATIVACAO.DATA_REATIVACAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.LOCALFATURAMENTO,TIPO_RESPONSAVEL,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
BEN.MOTIVOCANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
UNIO.CODIGO,UNI_ORIGEM,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REPASSE,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP, SAM_UNIMED           UNI, SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
BEN.BENEFICIARIO,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
CON.LOCALFATURAMENTO,ID_RESP_FINANCEIRO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN CPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'L' THEN LPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN FBEN.HANDLE WHEN FAM.PESSOARESPONSAVEL  IS NOT NULL THEN SFNP.HANDLE END END"
BEN.DATACANCELAMENTO,DATA_REATIVACAO,"CASE WHEN BEN.DATACANCELAMENTO > REATIVACAO.DATA_REATIVACAO THEN NULL ELSE REATIVACAO.DATA_REATIVACAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.LOCALFATURAMENTO,TIPO_RESPONSAVEL,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
BEN.MOTIVOCANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
UNIO.CODIGO,UNI_ORIGEM,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REPASSE,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP, SAM_UNIMED           UNI, SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
BEN.BENEFICIARIO,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
CON.LOCALFATURAMENTO,ID_RESP_FINANCEIRO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN CPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'L' THEN LPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN FBEN.HANDLE WHEN FAM.PESSOARESPONSAVEL  IS NOT NULL THEN SFNP.HANDLE END END"
BEN.DATACANCELAMENTO,DATA_REATIVACAO,"CASE WHEN BEN.DATACANCELAMENTO > REATIVACAO.DATA_REATIVACAO THEN NULL ELSE REATIVACAO.DATA_REATIVACAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.LOCALFATURAMENTO,TIPO_RESPONSAVEL,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
BEN.MOTIVOCANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
UNIO.CODIGO,UNI_ORIGEM,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REPASSE,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP, SAM_UNIMED           UNI, SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
BEN.BENEFICIARIO,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
CON.LOCALFATURAMENTO,ID_RESP_FINANCEIRO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN CPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'L' THEN LPES.HANDLE WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN FBEN.HANDLE WHEN FAM.PESSOARESPONSAVEL  IS NOT NULL THEN SFNP.HANDLE END END"
BEN.DATACANCELAMENTO,DATA_REATIVACAO,"CASE WHEN BEN.DATACANCELAMENTO > REATIVACAO.DATA_REATIVACAO THEN NULL ELSE REATIVACAO.DATA_REATIVACAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.LOCALFATURAMENTO,TIPO_RESPONSAVEL,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
BEN.MOTIVOCANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
UNIO.CODIGO,UNI_ORIGEM,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REPASSE,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP, SAM_UNIMED           UNI, SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"