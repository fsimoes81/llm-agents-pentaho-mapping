column_name,alias,rule
BEN.HANDLE,ID_BENEFICIARIO,NULL
BEN.FAMILIA,ID_BENEFICIARIO_RESP,"(SELECT MAX(BEN_TIT.HANDLE) FROM   SAM_BENEFICIARIO BEN_TIT WHERE  BEN_TIT.FAMILIA   = BEN.FAMILIA AND    BEN_TIT.EHTITULAR = 'S')"
CON.LOCALFATURAMENTO,ID_RESP_FINANCEIRO,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN CPES.HANDLE --CPES WHEN CON.LOCALFATURAMENTO = 'L' THEN LPES.HANDLE --LPES WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN FBEN.HANDLE --FBEN WHEN FAM.PESSOARESPONSAVEL  IS NOT NULL THEN SFNP.HANDLE --SFNP END END"
BEN.DATACANCELAMENTO,ID_MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.MOTIVOCANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.MOTIVOCANCELAMENTO END"
LOT.HANDLE,ID_CONTRATANTE_LOT,"NVL(LOT.HANDLE,0)"
BEN.BENEFICIARIO,CODIGO_UNI_PAG,"SUBSTR(BEN.BENEFICIARIO,1,4)"
BEN.Z_NOME,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
BEN.NOME,BENEFICIARIO,"NVL(TRIM(BEN.Z_NOME),TRIM(BEN.NOME))"
BEN.NAOTEMCARENCIA,NAO_TEM_CARENCIA,"DECODE(BEN.NAOTEMCARENCIA, 'S','Sim','N','Não')"
BEN.SOFREUADAPTACAO,SOFREU_ADAPTACAO,"DECODE(BEN.SOFREUADAPTACAO, 1,'Não',2,'Sim')"
BEN.TABORIGEM,ORIGEM,"DECODE(BEN.TABORIGEM, 1,'Próprio',2,'Assumido',3,'Assumido-Eventual')"
BEN.BLOQUEIARECADBIOAUTORIZADORWEB,BLOQUEAR_RECAD_BIO_AUT_WEB,"DECODE(BEN.BLOQUEIARECADBIOAUTORIZADORWEB,'S','Sim','N','Não')"
FAM.COBRANCANOMESSEGUINTE,COBRANCA_MES_SEGUINTE,"DECODE(FAM.COBRANCANOMESSEGUINTE,'S','Sim','N','Não')"
BEN.DATACANCELAMENTO,DATA_REATIVACAO,"CASE WHEN BEN.DATACANCELAMENTO > REATIVACAO.DATA_REATIVACAO THEN NULL ELSE REATIVACAO.DATA_REATIVACAO END"
BEN.DATACANCELAMENTO,DATA_CANCELAMENTO,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN BEN.DATACANCELAMENTO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE BEN.DATACANCELAMENTO END"
CON.INTERCAMBIO,INTERCAMBIO,"CASE WHEN CON.INTERCAMBIO = 1 THEN 'Sim' WHEN CON.INTERCAMBIO = 2 THEN 'Não' END"
FAM.LEIDEMITIDOSAPOSENTADOS,SITUACAO_FAMILIA,"CASE WHEN FAM.LEIDEMITIDOSAPOSENTADOS = 1 THEN 'Ativo' WHEN FAM.LEIDEMITIDOSAPOSENTADOS = 2 THEN 'Demitido' WHEN FAM.LEIDEMITIDOSAPOSENTADOS = 3 THEN 'Aposentado' END"
CBO.ESTRUTURA,CBO,"CBO.ESTRUTURA||' - '||CBO.DESCRICAO"
CBO.DESCRICAO,CBO,"CBO.ESTRUTURA||' - '||CBO.DESCRICAO"
CON.CONTRATO,MATRIC_BEN_EMPRESA,"CASE WHEN CON.CONTRATO = 53478 AND TPDEP.DESCRICAO = 'Titular' THEN LPAD(BEN.MATRICULAFUNCIONAL,6,0) ELSE BEN.MATRICULAFUNCIONAL END"
BEN.MATRICULAFUNCIONAL,MATRIC_BEN_EMPRESA,"CASE WHEN CON.CONTRATO = 53478 AND TPDEP.DESCRICAO = 'Titular' THEN LPAD(BEN.MATRICULAFUNCIONAL,6,0) ELSE BEN.MATRICULAFUNCIONAL END"
BEN.DATACANCELAMENTO,MOTIVO_CANC,"CASE WHEN BEN.DATACANCELAMENTO < SYSDATE THEN MCAN.DESCRICAO WHEN MCAN.CODIGO = 101 AND (BEN.TABORIGEM = 3 OR (BEN.TABORIGEM = 2 AND CON.ESPELHO = 'S')) THEN NULL ELSE MCAN.DESCRICAO END"
BEN.MOTIVOINCLUSAO,MOTIVO_INCLUSAO,"CASE WHEN BEN.MOTIVOINCLUSAO = 5 THEN 'Novo beneficiário' WHEN BEN.MOTIVOINCLUSAO = 6 THEN 'Transferência voluntária de carteira' WHEN BEN.MOTIVOINCLUSAO = 7 THEN 'Transferência compulsória de carteira' ELSE NULL END"
UNIO.CODIGO,TIPO_BENEFICIARIO,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIDES.UNIMED_DESTINO,TIPO_BENEFICIARIO,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
BEN.TABORIGEM,TIPO_BENEFICIARIO,"CASE WHEN NVL(UNIO.CODIGO,'0032') = '0032' AND NVL(UNIDES.UNIMED_DESTINO,'0032') = '0032' THEN 'Próprio' WHEN NVL(UNIDES.UNIMED_DESTINO,'0032') <> '0032' THEN 'Repassado' WHEN NVL(UNIO.CODIGO,'0032') <> '0032' THEN CASE WHEN BEN.TABORIGEM = 2 THEN 'Assumido' WHEN BEN.TABORIGEM = 3 THEN 'Assumido-Eventual' ELSE 'Assumido' END END"
UNIO.HANDLE,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
CAMCOM.DESCRICAO,UNI_ORIGEM_CAMARA_COMPENSACAO,"CASE WHEN UNIO.HANDLE IS NULL THEN 'Estadual' WHEN CAMCOM.DESCRICAO IS NULL THEN 'Sem Informação' ELSE CAMCOM.DESCRICAO END"
UNIO.HANDLE,UNI_ORIGEM_TIPO_CAMARA_COMP,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
CAMCOM.TIPOCAMARA,UNI_ORIGEM_TIPO_CAMARA_COMP,"CASE WHEN UNIO.HANDLE IS NULL THEN '2-Federativa' WHEN CAMCOM.TIPOCAMARA IS NULL THEN 'Sem Informação' ELSE DECODE(CAMCOM.TIPOCAMARA ,1,'1-Intra-Federativa',2,'2-Federativa',3,'3-Inter-Federativa',4,'4-Nacional') END"
UNIDES.UNIMED_DESTINO,TIPO_FATURAMENTO_REP,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP , SAM_UNIMED           UNI , SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
CON.HANDLE,TIPO_FATURAMENTO_REP,"CASE WHEN UNIDES.UNIMED_DESTINO IS NOT NULL THEN ( SELECT TIP.DESCRICAO FROM SIS_TIPOFATURAMENTO  TIP , SAM_UNIMED           UNI , SAM_REPASSEINTER     REP WHERE TIP.HANDLE       = REP.TIPOFATURAMENTO AND UNI.CODIGO       = UNIDES.UNIMED_DESTINO AND UNI.HANDLE       = REP.UNIMEDDESTINO AND REP.DATAINICIAL <= TRUNC(SYSDATE) AND ( REP.DATAFINAL IS NULL OR REP.DATAFINAL >= TRUNC(SYSDATE) ) AND REP.CONTRATO      = CON.HANDLE AND ROWNUM            = 1 ) ELSE NULL END"
BEN.FAMILIA,ANOTACAO_ADM_FAMILIA,"(SELECT LISTAGG(SUBSTR('('||TO_CHAR(F.DATA,'DD/MM/YYYY')||') '||A.DESCRICAO||': '||SUBSTR(F.OBSERVACAO,0,255),0,4000), ', ') WITHIN GROUP (ORDER BY 1) FROM   SAM_FAMILIA_ANOTADM F LEFT   JOIN SAM_ANOTACAOADMINISTRATIVA A ON F.ANOTACAO = A.HANDLE WHERE   F.FAMILIA = BEN.FAMILIA)"
BEN.BENEFICIARIO,POSSUI_BIOMETRIA,"CASE WHEN EXISTS (SELECT 1 FROM   AWE_BIOMETRIA BIO WHERE  BIO.TIPO = 'B' AND    BIO.OPERADORA||SUBSTR(BIO.CODIGO,1,LENGTH(BIO.CODIGO)-1) = BEN.BENEFICIARIO) THEN 'Sim' ELSE 'Não' END"
CON.DATAADESAO,CPT,"CASE  WHEN ((SELECT MAX(CID.QTDCPT) FROM SAM_BENEFICIARIO_CID CID       WHERE CID.BENEFICIARIO = BEN.HANDLE) > SYSDATE - CON.DATAADESAO) OR ((SELECT MAX(EVE.QTDCPT) FROM SAM_BENEFICIARIO_EVENTO EVE    WHERE EVE.BENEFICIARIO = BEN.HANDLE) > SYSDATE - CON.DATAADESAO) OR ((SELECT MAX(PAT.QTDCPT) FROM SAM_BENEFICIARIO_PATOLOGIA PAT WHERE PAT.BENEFICIARIO = BEN.HANDLE) > SYSDATE - CON.DATAADESAO) THEN           'S' ELSE           'N' END"
CON.LOCALFATURAMENTO,TIPO_RESPONSAVEL,"CASE WHEN CON.LOCALFATURAMENTO = 'C' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'L' THEN 'P' WHEN CON.LOCALFATURAMENTO = 'F' THEN CASE WHEN FAM.TITULARRESPONSAVEL IS NOT NULL THEN 'B' WHEN FAM.PESSOARESPONSAVEL IS NOT NULL THEN 'P' END END"
ENDR.DDD2,TELEFONE2,"'('||ENDR.DDD2||') '||ENDR.PREFIXO2||'-'||ENDR.NUMERO2"
ENDR.PREFIXO2,TELEFONE2,"'('||ENDR.DDD2||') '||ENDR.PREFIXO2||'-'||ENDR.NUMERO2"
ENDR.NUMERO2,TELEFONE2,"'('||ENDR.DDD2||') '||ENDR.PREFIXO2||'-'||ENDR.NUMERO2"
ENDR.DDDCELULAR,CELULAR,"'('||ENDR.DDDCELULAR||') '||ENDR.PREFIXOCELULAR||'-'||ENDR.NUMEROCELULAR"
ENDR.PREFIXOCELULAR,CELULAR,"'('||ENDR.DDDCELULAR||') '||ENDR.PREFIXOCELULAR||'-'||ENDR.NUMEROCELULAR"
ENDR.NUMEROCELULAR,CELULAR,"'('||ENDR.DDDCELULAR||') '||ENDR.PREFIXOCELULAR||'-'||ENDR.NUMEROCELULAR"
ENDC.DDD1,TELEFONE1_CORRESP,"'('||ENDC.DDD1||') '||ENDC.PREFIXO1||'-'||ENDC.NUMERO1"
ENDC.PREFIXO1,TELEFONE1_CORRESP,"'('||ENDC.DDD1||') '||ENDC.PREFIXO1||'-'||ENDC.NUMERO1"
ENDC.NUMERO1,TELEFONE1_CORRESP,"'('||ENDC.DDD1||') '||ENDC.PREFIXO1||'-'||ENDC.NUMERO1"
ENDC.DDD2,TELEFONE2_CORRESP,"'('||ENDC.DDD2||') '||ENDC.PREFIXO2||'-'||ENDC.NUMERO2"
ENDC.PREFIXO2,TELEFONE2_CORRESP,"'('||ENDC.DDD2||') '||ENDC.PREFIXO2||'-'||ENDC.NUMERO2"
ENDC.NUMERO2,TELEFONE2_CORRESP,"'('||ENDC.DDD2||') '||ENDC.PREFIXO2||'-'||ENDC.NUMERO2"
ENDC.DDDCELULAR,CELULAR_CORRESP,"'('||ENDC.DDDCELULAR||') '||ENDC.PREFIXOCELULAR||'-'||ENDC.NUMEROCELULAR"
ENDC.PREFIXOCELULAR,CELULAR_CORRESP,"'('||ENDC.DDDCELULAR||') '||ENDC.PREFIXOCELULAR||'-'||ENDC.NUMEROCELULAR"
ENDC.NUMEROCELULAR,CELULAR_CORRESP,"'('||ENDC.DDDCELULAR||') '||ENDC.PREFIXOCELULAR||'-'||ENDC.NUMEROCELULAR"
BAS.UNIMEDEMCASA,UNIMED_EM_CASA,"DECODE(BAS.UNIMEDEMCASA,'N','Não','S','Sim',BAS.UNIMEDEMCASA)"
BAS.BEMESTARESAUDE,BEM_ESTAR_E_SAUDE,"DECODE(BAS.BEMESTARESAUDE,'N','Não','S','Sim',BAS.BEMESTARESAUDE)"
FAM.USUARIOINCLUSAO,USUARIO_INCLUSAO_FAMILIA,"(SELECT USU.NOME FROM Z_GRUPOUSUARIOS USU WHERE USU.HANDLE = FAM.USUARIOINCLUSAO)"
UNIO.CODIGO,UNI_ORIGEM,"NVL(UNIO.CODIGO,'0032')"
UNIO.RAZAOSOCIAL,UNI_ORIGEM_RAZAOSOCIAL,"NVL(NVL(UNIO_PES.NOME,UNIO.RAZAOSOCIAL),'UNIMED CURITIBA SOC COOPERATIVA MEDICOS')"
UNIO_PES.NOME,UNI_ORIGEM_RAZAOSOCIAL,"NVL(NVL(UNIO_PES.NOME,UNIO.RAZAOSOCIAL),'UNIMED CURITIBA SOC COOPERATIVA MEDICOS')"
POL.DESCRICAO,UNI_ORIGEM_DESC_POLITICA,"NVL(POL.DESCRICAO,'Estadual')"
UNIDES.UNIMED_DESTINO,UNI_DESTINO,"NVL(UNIDES.UNIMED_DESTINO,'0032')"
UNIDES.UNIMED_DESTINO_RAZAOSOCIAL,UNI_DESTINO_RAZAOSOCIAL,"NVL(UNIDES.UNIMED_DESTINO_RAZAOSOCIAL,'UNIMED CURITIBA SOC COOPERATIVA MEDICOS')"
ESTUNIO.SIGLA,UF_UNI_ORIGEM,"NVL(ESTUNIO.SIGLA,'PR')"
BC.SITUACAO,SITUACAO_CARTAO,"DECODE(BC.SITUACAO, 'B', 'Bloqueado','C','Cancelado','N','Normal')"
BC.SITUACAOATUALIZADADOS,SITUACAO_ATUALIZACAO_DADOS,"DECODE(BC.SITUACAOATUALIZADADOS, 'B','Bloqueado','D', 'Desbloqueado')"